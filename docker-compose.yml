name: CodeClique-dev

services:
  proxy:
    image: nginx:mainline-alpine
    volumes:
      - type: bind
        source: ./proxy/nginx.conf
        target: /etc/nginx/conf.d/default.conf
        read_only: true
    ports:
      - "80:80"
      - "443:443"
    profiles: ["frontend", "backend", "full"]

  frontend:
    build:
      context: ../frontend
      dockerfile: Dockerfile
    profiles: ["frontend", "full"]
    develop:
      watch:
        - action: sync
          path: ../frontend/src
          target: /app/src

  backend:
    build:
      context: ../backend
      dockerfile: Dockerfile
    profiles: ["backend", "full"]
    develop:
      watch:
        - action: sync
          path: ../backend/src
          target: /app/src